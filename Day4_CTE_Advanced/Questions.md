# Day 4 â€“ CTEs and Advanced Queries

### Question 1
Create a CTE to calculate the total revenue for each product category in the month of October 2023.
Only include categories with at least one sale in that month. Sort results by category in ascending order.

### Question 2
Retrieve a list of customer cities where the customers have a grade of 2.
For each city, calculate:
- Total opening amount
- Average receive amount
- Maximum payment amount  
Only include cities where the average receive amount exceeds 500.
Sort results in ascending order by total opening amount.

### Question 3
Use a CTE to find agents who handle more than 2 customers. Show their agent codes and number of customers.

### Question 4
With the help of a subquery or CTE, display customers whose payment amount is more than the average payment across all customers.

### Question 5
Find the agent(s) whose total outstanding amount of customers is the highest. Use subqueries or CTE to support the logic.
